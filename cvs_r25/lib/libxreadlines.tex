\section{\module{xreadlines} ---
         ファイルの各行に対する効率のよい反復処理}

\declaremodule{extension}{xreadlines}
\modulesynopsis{ファイルの各行に対する効率のよい反復処理。}

\versionadded{2.1}

\deprecated{2.3}{\code{for line in file} を代わりに使ってください。}

このモジュールでは、あるファイル内の各行に対して効率的に反復を行える
ような新たなオブジェクト型を定義します。xreadline オブジェクトは
\keyword{for} 文や関数 \function{filter()} で必要とされるような、
\code{0} から始まる単純かつ順序正しいインデクス付けを実装したシーケンス型
です。

つまり、以下のコード

\begin{verbatim}
import xreadlines, sys

for line in xreadlines.xreadlines(sys.stdin):
    pass
\end{verbatim}

は、

\begin{verbatim}
while 1:
    lines = sys.stdin.readlines(8*1024)
    if not lines: break
    for line in lines:
        pass
\end{verbatim}

とだいたい同じ速度とメモリ消費になります。ただし前者は \keyword{for} 
文のままなのでより明快です。

\begin{funcdesc}{xreadlines}{fileobj}
  \var{fileobj} の内容にわたって反復を行うような、新しい xreadlines 
  オブジェクトを返します。\var{fileobj} は、引数 \var{sizehint} を
  サポートする \method{readlines()} メソッドを持っていなければなりません。
  \note{\method{readlines()} メソッドばデータをバッファするので、ファイル
  オブジェクトを非バッファリングに設定しても無視されます。}
\end{funcdesc}

xreadlines オブジェクト \var{s} は以下のシーケンス操作をサポートします:

\begin{tableii}{c|l}{code}{操作}{結果}
 \lineii{\var{s}[\var{i}]}{\var{s} の \var{i} 行目}
\end{tableii}

\var{i} の値が \code{0} から始まる連続した数でない場合、 このコードは
例外\exception{RuntimeError} を送出します。

ファイルの最後の行が読み出された後、このコードは例外 \exception{IndexError}
を送出します。

