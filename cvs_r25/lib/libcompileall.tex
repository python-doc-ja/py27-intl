\section{\module{compileall} ---
         Pythonライブラリをバイトコンパイル}

\declaremodule{standard}{compileall}
\modulesynopsis{ディレクトリに含まれるPythonソースファイルを、一括してバイトコンパイルします。}

このモジュールは、指定したディレクトリに含まれるPythonソースをコンパイル
する関数を定義しています。Pythonライブラリをインストールする時、ソースフ
ァイルを事前にコンパイルしておく事により、ライブラリのインストール先ディ
レクトリに書き込み権限をもたないユーザでもキャッシュされたバイトコードフ
ァイルを利用する事ができるようになります。

このモジュールのソースコードは、Pytonソースファイルをコンパイルするスク
リプトとしても利用する事ができます。コンパイルするディレクトリは、
\code{sys.path}で指定されたディレクトリ、またはコマンドラインで指定され
たディレクトリとなります。

\begin{funcdesc}{compile_dir}{dir\optional{, maxlevels\optional{,
                              ddir\optional{, force\optional{, 
                              rx\optional{, quiet}}}}}}

  \var{dir}で指定されたディレクトリを再帰的に下降し、見つかった
  \file{.py}を全てコンパイルします。\var{maxlevels}は、下降する最大の深
  さ（デフォルトは\code{10}）を指定します。\var{ddir}には、エラーメッ
  セージで使用されるファイル名の、親ディレクトリ名を指定する事ができま
  す。\var{force}が真の場合、モジュールはファイルの更新日付に関わりなく
  再コンパイルされます。

  \var{rx}には、検索対象から除外するファイル名の正規表現式を指定します。
  絶対パス名をこの正規表現で\code{search}し、一致した場合にはコンパイル
  対象から除外します。

  \var{quiet}が真の場合、通常処理では標準出力に何も表示しません。
  
\end{funcdesc}

\begin{funcdesc}{compile_path}{\optional{skip_curdir\optional{,
                               maxlevels\optional{, force}}}}

  \code{sys.path}に含まれる、全ての\file{.py}ファイルをバイトコンパイル
  します。\var{skip_curdir}が真（デフォルト）の時、カレントディレクトリ
  は検索されません。\var{maxlevels}と\var{force}はデフォルトでは\code{0}
  で、\function{compile_dir()}に渡されます。

\end{funcdesc}


\file{Lib/}ディレクトリ以下にある全ての\file{.py}ファイルを強制的にリコンパイル
するには、以下のようにします:

\begin{verbatim}
import compileall

compileall.compile_dir('Lib/', force=True)

# .svnディレクトリにあるファイルをのぞいて同じことをするにはこのようにします。
import re
compileall.compile_dir('Lib/', rx=re.compile('/[.]svn'), force=True)
\end{verbatim}


\begin{seealso}
  \seemodule[pycompile]{py_compile}{Byte-compile a single source file.}
\end{seealso}

