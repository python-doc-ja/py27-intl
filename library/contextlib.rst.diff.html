<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>library/contextlib.rst</title>
<style type="text/css">
.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #808080 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0040D0 } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */
</style>
</head>
<body>
<div class="highlight"><pre><span class="gu">@@ -2,24 +2,29 @@</span>
 ========================================================================
 
 .. module:: contextlib
    :synopsis: Utilities for with-statement contexts.
 
 
 .. versionadded:: 2.5
 
 This module provides utilities for common tasks involving the :keyword:`with`
 statement. For more information see also :ref:`typecontextmanager` and
 :ref:`context-managers`.
 
<span class="gi">+.. seealso::</span>
<span class="gi">+</span>
<span class="gi">+   Latest version of the `contextlib Python source code</span>
<span class="gi">+   &lt;http://svn.python.org/view/python/branches/release27-maint/Lib/contextlib.py?view=markup&gt;`_</span>
<span class="gi">+</span>
 Functions provided:
 
 
 .. function:: contextmanager(func)
 
    This function is a :term:`decorator` that can be used to define a factory
    function for :keyword:`with` statement context managers, without needing to
    create a class or separate :meth:`__enter__` and :meth:`__exit__` methods.
 
    A simple example (this is not recommended as a real way of generating HTML!)::
 
       from contextlib import contextmanager
<span class="gu">@@ -49,48 +54,67 @@</span>
    the error (if any), or ensure that some cleanup takes place. If an exception is
    trapped merely in order to log it or to perform some action (rather than to
    suppress it entirely), the generator must reraise that exception. Otherwise the
    generator context manager will indicate to the :keyword:`with` statement that
    the exception has been handled, and execution will resume with the statement
    immediately following the :keyword:`with` statement.
 
 
 .. function:: nested(mgr1[, mgr2[, ...]])
 
    Combine multiple context managers into a single nested context manager.
 
<span class="gd">-   Code like this::</span>
<span class="gi">+   This function has been deprecated in favour of the multiple manager form</span>
<span class="gi">+   of the :keyword:`with` statement.</span>
<span class="gi">+</span>
<span class="gi">+   The one advantage of this function over the multiple manager form of the</span>
<span class="gi">+   :keyword:`with` statement is that argument unpacking allows it to be</span>
<span class="gi">+   used with a variable number of context managers as follows::</span>
 
       from contextlib import nested
 
<span class="gd">-      with nested(A(), B(), C()) as (X, Y, Z):</span>
<span class="gi">+      with nested(*managers):</span>
           do_something()
 
<span class="gd">-   is equivalent to this::</span>
<span class="gd">-</span>
<span class="gd">-      m1, m2, m3 = A(), B(), C()</span>
<span class="gd">-      with m1 as X:</span>
<span class="gd">-          with m2 as Y:</span>
<span class="gd">-              with m3 as Z:</span>
<span class="gd">-                  do_something()</span>
<span class="gd">-</span>
    Note that if the :meth:`__exit__` method of one of the nested context managers
    indicates an exception should be suppressed, no exception information will be
    passed to any remaining outer context managers. Similarly, if the
    :meth:`__exit__` method of one of the nested managers raises an exception, any
    previous exception state will be lost; the new exception will be passed to the
    :meth:`__exit__` methods of any remaining outer context managers. In general,
    :meth:`__exit__` methods should avoid raising exceptions, and in particular they
    should not re-raise a passed-in exception.
 
<span class="gi">+   This function has two major quirks that have led to it being deprecated. Firstly,</span>
<span class="gi">+   as the context managers are all constructed before the function is invoked, the</span>
<span class="gi">+   :meth:`__new__` and :meth:`__init__` methods of the inner context managers are</span>
<span class="gi">+   not actually covered by the scope of the outer context managers. That means, for</span>
<span class="gi">+   example, that using :func:`nested` to open two files is a programming error as the</span>
<span class="gi">+   first file will not be closed promptly if an exception is thrown when opening</span>
<span class="gi">+   the second file.</span>
<span class="gi">+</span>
<span class="gi">+   Secondly, if the :meth:`__enter__` method of one of the inner context managers</span>
<span class="gi">+   raises an exception that is caught and suppressed by the :meth:`__exit__` method</span>
<span class="gi">+   of one of the outer context managers, this construct will raise</span>
<span class="gi">+   :exc:`RuntimeError` rather than skipping the body of the :keyword:`with`</span>
<span class="gi">+   statement.</span>
<span class="gi">+</span>
<span class="gi">+   Developers that need to support nesting of a variable number of context managers</span>
<span class="gi">+   can either use the :mod:`warnings` module to suppress the DeprecationWarning</span>
<span class="gi">+   raised by this function or else use this function as a model for an application</span>
<span class="gi">+   specific implementation.</span>
<span class="gi">+</span>
<span class="gi">+   .. deprecated:: 2.7</span>
<span class="gi">+      The with-statement now supports this functionality directly (without the</span>
<span class="gi">+      confusing error prone quirks).</span>
 
 .. function:: closing(thing)
 
    Return a context manager that closes *thing* upon completion of the block.  This
    is basically equivalent to::
 
       from contextlib import contextmanager
 
       @contextmanager
       def closing(thing):
           try:
               yield thing
</pre></div>

</body>
</html>