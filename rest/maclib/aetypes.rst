
:mod:`aetypes` --- AppleEvent オブジェクト
====================================

.. module:: aetypes
   :platform: Mac
   :synopsis: Apple Event オブジェクトモデルの Python 表現
.. sectionauthor:: Vincent Marchetti <vincem@en.com>


.. % AppleEvent objects
.. % \moduleauthor{Jack Jansen?}{email}
.. % Python representation of the Apple Event Object Model.

:mod:`aetypes` では、 Apple Event データデスクリプタ (data descriptor) や Apple
Eventオブジェクト指定子 (object specifier) を表現するクラスを定義しています。

.. % % The \module{aetypes} defines classes used to represent Apple Event data
.. % % descriptors and Apple Event object specifiers.

Apple Event データはデスクリプタに含まれていて、これらのデスクリプタは 片付けされています。多くのデスクリプタは、単に対応するPython の型で
表現されています。例えば、OSA 中の ``typeText`` は Python 文字 列型で、``typeFloat`` は
浮動小数点型になる、といった具合です。 このモジュールでは、OSA の型のうち、直接的に対応する Python の型がない
もののためにクラスを定義しています。そのようなクラスのインスタンスに対 するパックやアンパック操作は、 :mod:`aepack` モジュール自動的に処理
します。

.. % % Apple Event data is is contained in descriptors, and these descriptors
.. % % are typed. For many descriptors the Python representation is simply the
.. % % corresponding Python type: \code{typeText} in OSA is a Python string,
.. % % \code{typeFloat} is a float, etc. For OSA types that have no direct
.. % % Python counterpart this module declares classes. Packing and unpacking
.. % % instances of these classes is handled automatically by \module{aepack}.

オブジェクト指定子は、本質的には Apple Event サーバ中に実装されている オブジェクトへのアドレスです。Apple Event 指定子は、Apple
Event の オブジェクトそのものとして、あるいはオプションパラメタの引数として 使われます。 :mod:`aetypes` モジュールには OSA
クラスやプロパティを表現するための 基底クラスが入っています。これらのクラスは、:mod:`gensuitemodule`
が生成するパッケージ内で、目的に応じてクラスやプロパティを増やす 際に使われます。

.. % % An object specifier is essentially an address of an object implemented
.. % % in a Apple Event server. An Apple Event specifier is used as the direct
.. % % object for an Apple Event or as the argument of an optional parameter.
.. % % The \module{aetypes} module contains the base classes for OSA classes
.. % % and properties, which are used by the packages generated by
.. % % \module{gensuitemodule} to populate the classes and properties in a
.. % % given suite.

以前のバージョンとの互換性や、スタブパッケージを生成していないような アプリケーションをスクリプトで書く必要がある場合のために、
このモジュールには``Document`` 、``Window``、``Character``、 といったよく使われる OSA
クラスのいくつかを指定できるオブジェクト 指定子も入っています。

.. % % For reasons of backward compatibility, and for cases where you need to
.. % % script an application for which you have not generated the stub package
.. % % this module also contains object specifiers for a number of common OSA
.. % % classes such as \code{Document}, \code{Window}, \code{Character}, etc.

:mod:`AEObjects` モジュールでは、以下のようなクラスを定義して、 Apple Event デスクリプタデータを表現しています:

.. % % The \module{AEObjects} module defines the following classes to represent
.. % % Apple Event descriptor data:


.. class:: Unknown(type, data)

   :mod:`aepack` や :mod:`aetypes` がサポートしていない OSA の
   デスクリプタデータ、すなわち、このモジュールで扱っている他のクラスや、 Python の組み込み型の値で表現されていないようなデータを表現するクラスです。

   .. % % The representation of OSA descriptor data for which the \module{aepack}
   .. % % and \module{aetypes} modules have no support, i.e. anything that is not
   .. % % represented by the other classes here and that is not equivalent to a
   .. % % simple Python value.


.. class:: Enum(enum)

   列挙値 (enumeration value) を表すクラスです。 値は 4 文字の文字列型になります。

   .. % % An enumeration value with the given 4-character string value.


.. class:: InsertionLoc(of, pos)

   オブジェクト ``of`` の中の ``pos`` の位置を表すクラスです。

   .. % % Position \code{pos} in object \code{of}.


.. class:: Boolean(bool)

   ブール値 (真偽値) を表すクラスです。

   .. % % A boolean.


.. class:: StyledText(style, text)

   スタイル情報 (フォント、タイプフェイスなど) つきのテキストを表す クラスです。

   .. % % Text with style information (font, face, etc) included.


.. class:: AEText(script, style, text)

   スクリプトシステム (script system) およびスタイル情報の入った テキストを表すクラスです。

   .. % % Text with script system and style information included.


.. class:: IntlText(script, language, text)

   スクリプトシステムと言語情報 (language information) の入った テキストを表すクラスです。

   .. % % Text with script system and language information included.


.. class:: IntlWritingCode(script, language)

   スクリプトシステムと言語情報を表すクラスです。

   .. % % Script system and language information.


.. class:: QDPoint(v, h)

   QuickDrawの点を表すクラスです。

   .. % % A quickdraw point.


.. class:: QDRectangle(v0, h0, v1, h1)

   QuickDrawの矩形を表すクラスです。

   .. % % A quickdraw rectangle.


.. class:: RGBColor(r, g, b)

   色を表すクラスです。

   .. % % A color.


.. class:: Type(type)

   OSA の型 (type value) を表すクラスです。 4 文字からなる名前を値に持ちます。

   .. % % An OSA type value with the given 4-character name.


.. class:: Keyword(name)

   OSA のキーワードです。 4 文字からなる名前を値に持ちます。

   .. % % An OSA keyword with the given 4-character name.


.. class:: Range(start, stop)

   範囲を表すクラスです。

   .. % % A range.


.. class:: Ordinal(abso)

   先頭を表す ``"firs"`` や中央を表す``"midd"`` のように、 数値でない絶対位置指定子を表すクラスです。

   .. % % Non-numeric absolute positions, such as \code{"firs"}, first, or \code{"midd"},
   .. % % middle.


.. class:: Logical(logc, term)

   演算子 ``logc`` を``term`` に適用したときの論理式を 表すクラスです。

   .. % % The logical expression of applying operator \code{logc} to
   .. % % \code{term}.


.. class:: Comparison(obj1, relo, obj2)

   ``obj1`` と ``obj2`` の ``relo`` による比較を表すクラスです。

   .. % % The comparison \code{relo} of \code{obj1} to \code{obj2}.

以下のクラスは、生成されたスタブパッケージが、 AppleScript のクラスやプロパティを Python で表現する上で 基底クラスとして利用します。

.. % % The following classes are used as base classes by the generated stub
.. % % packages to represent AppleScript classes and properties in Python:


.. class:: ComponentItem(which[, fr])

   OSA クラス用の抽象基底クラスです。サブクラスでは、クラス属性 ``want`` を 4 文字の OSA クラスコードに設定せねばなりません。
   このクラスのサブクラスのインスタンスは AppleScript オブジェクト指定子 と同じになります。インスタンス化を行う最には、``which``
   にセレクタを 渡さねばなりません。また、任意で親オブジェクトを``fr`` に渡せます。

   .. % % Abstract baseclass for an OSA class. The subclass should set the class
   .. % % attribute \code{want} to the 4-character OSA class code. Instances of
   .. % % subclasses of this class are equivalent to AppleScript Object
   .. % % Specifiers. Upon instantiation you should pass a selector in
   .. % % \code{which}, and optionally a parent object in \code{fr}.


.. class:: NProperty(fr)

   OSA プロパティ用の抽象基底クラスです。サブクラスでは、クラス属性 ``want`` と ``which`` を設定して、どのプロパティを表しているかを
   指定せねばなりません。このクラスのサブクラスのインスタンスは オブジェクト指定子と同じになります。

   .. % % Abstract basclass for an OSA property. The subclass should set the class
   .. % % attributes \code{want} and \code{which} to designate which property we
   .. % % are talking about. Instances of subclasses of this class are Object
   .. % % Specifiers.


.. class:: ObjectSpecifier(want, form, seld[, fr])

   ``ComponentItem`` と ``NProperty`` の基底クラスで、汎用の OSA  オブジェクト指定子を表します。パラメタの説明は Apple
   Open Scripting Architecture のドキュメントを参照してください。 このクラスは抽象クラスではないので注意してください。

   .. % % Base class of \code{ComponentItem} and \code{NProperty}, a general
   .. % % OSA Object Specifier. See the Apple Open Scripting Architecture
   .. % % documentation for the parameters. Note that this class is not abstract.

