<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.5: http://docutils.sourceforge.net/" />
<title>:mod:`asyncore` --- 非同期ソケットハンドラ</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 5196 2007-06-03 20:25:28Z wiemann $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left {
  clear: left }

img.align-right {
  clear: right }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font-family: serif ;
  font-size: 100% }

pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="mod-asyncore">
<h1 class="title"><a href="#id1"><span class="problematic" id="id2">:mod:`asyncore`</span></a> --- 非同期ソケットハンドラ</h1>

<div class="system-message" id="id1">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">library/asyncore.rst</tt>, line 2); <em><a href="#id2">backlink</a></em></p>
Unknown interpreted text role &quot;mod&quot;.</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">library/asyncore.rst</tt>, line 5)</p>
<p>Unknown directive type &quot;module&quot;.</p>
<pre class="literal-block">
.. module:: asyncore
   :synopsis: 非同期なソケット制御サービスのためのベースクラス
</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">library/asyncore.rst</tt>, line 7)</p>
<p>Unknown directive type &quot;moduleauthor&quot;.</p>
<pre class="literal-block">
.. moduleauthor:: Sam Rushing &lt;rushing&#64;nightmare.com&gt;
</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">library/asyncore.rst</tt>, line 8)</p>
<p>Unknown directive type &quot;sectionauthor&quot;.</p>
<pre class="literal-block">
.. sectionauthor:: Christopher Petrilli &lt;petrilli&#64;amber.org&gt;
</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">library/asyncore.rst</tt>, line 9)</p>
<p>Unknown directive type &quot;sectionauthor&quot;.</p>
<pre class="literal-block">
.. sectionauthor:: Steve Holden &lt;sholden&#64;holdenweb.com&gt;


</pre>
</div>
<p>このモジュールは、非同期ソケットサービスのクライアント・サーバを開発する ための基盤として使われます。</p>
<!-- % Heavily adapted from original documentation by Sam Rushing. -->
<p>CPUが一つしかない場合、プログラムが&quot;二つのことを同時に&quot;実行する方法は 二つしかありません。もっとも簡単で一般的なのはマルチスレッドを利用する方
法ですが、これとはまったく異なるテクニックで、一つのスレッドだけでマルチ スレッドと同じような効果を得られるテクニックがあります。このテクニックは
I/O処理が中心である場合にのみ有効で、CPU負荷の高いプログラムでは効果が無 く、この場合にはプリエンプティブなスケジューリングが可能なスレッドが有効
でしょう。しかし、多くの場合、ネットワークサーバではCPU負荷よりはIO負荷 が問題となります。</p>
<p>もしOSのI/Oライブラリがシステムコール <a href="#id3"><span class="problematic" id="id4">:cfunc:`select`</span></a> をサポートし
ている場合（ほとんどの場合はサポートされている）、I/O処理は&quot;バックグラ ウンド&quot;で実行し、その間に他の処理を実行すれば、複数の通信チャネルを同時
にこなすことができます。一見、この戦略は奇妙で複雑に思えるかもしれません が、いろいろな面でマルチスレッドよりも理解しやすく、制御も容易です。
:mod:<a href="#id5"><span class="problematic" id="id6">`</span></a>asyncore`は多くの複雑な問題を解決済みなので、洗練され、パフォー マンスにも優れたネットワークサーバとクライアントを簡単に開発することがで
きます。とくに、:mod:<a href="#id7"><span class="problematic" id="id8">`</span></a>asynchat`のような、対話型のアプリケーションや プロトコルには非常に有効でしょう。</p>
<div class="system-message" id="id3">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">library/asyncore.rst</tt>, line 21); <em><a href="#id4">backlink</a></em></p>
Unknown interpreted text role &quot;cfunc&quot;.</div>
<div class="system-message" id="id5">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">library/asyncore.rst</tt>, line 21); <em><a href="#id6">backlink</a></em></p>
Inline interpreted text or phrase reference start-string without end-string.</div>
<div class="system-message" id="id7">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">library/asyncore.rst</tt>, line 21); <em><a href="#id8">backlink</a></em></p>
Inline interpreted text or phrase reference start-string without end-string.</div>
<p>基本的には、この二つのモジュールを使う場合は一つ以上のネットワーク <a href="#id9"><span class="problematic" id="id10">*</span></a>チャネル*を:class:<a href="#id11"><span class="problematic" id="id12">`</span></a>asyncore.dispatcher`クラス、または
:class:<a href="#id13"><span class="problematic" id="id14">`</span></a>asynchat.async_chat`のインスタンスとして作成します。作成されたチ
ャネルはグローバルマップに登録され、:func:<a href="#id15"><span class="problematic" id="id16">`</span></a>loop`関数で参照されま す。:func:<a href="#id17"><span class="problematic" id="id18">`</span></a>loop`には、専用のマップを渡す事も可能です。</p>
<div class="system-message" id="id9">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">library/asyncore.rst</tt>, line 27); <em><a href="#id10">backlink</a></em></p>
Inline emphasis start-string without end-string.</div>
<div class="system-message" id="id11">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">library/asyncore.rst</tt>, line 27); <em><a href="#id12">backlink</a></em></p>
Inline interpreted text or phrase reference start-string without end-string.</div>
<div class="system-message" id="id13">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">library/asyncore.rst</tt>, line 27); <em><a href="#id14">backlink</a></em></p>
Inline interpreted text or phrase reference start-string without end-string.</div>
<div class="system-message" id="id15">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">library/asyncore.rst</tt>, line 27); <em><a href="#id16">backlink</a></em></p>
Inline interpreted text or phrase reference start-string without end-string.</div>
<div class="system-message" id="id17">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">library/asyncore.rst</tt>, line 27); <em><a href="#id18">backlink</a></em></p>
Inline interpreted text or phrase reference start-string without end-string.</div>
<p>チャネルを生成後、:func:<a href="#id19"><span class="problematic" id="id20">`</span></a>loop`を呼び出すとチャネル処理が開始し、最 後のチャネル（非同期処理中にマップに追加されたチャネルを含む）が閉じるま
で継続します。</p>
<div class="system-message" id="id19">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">library/asyncore.rst</tt>, line 31); <em><a href="#id20">backlink</a></em></p>
Inline interpreted text or phrase reference start-string without end-string.</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">library/asyncore.rst</tt>, line 35)</p>
<p>Unknown directive type &quot;function&quot;.</p>
<pre class="literal-block">
.. function:: loop([timeout[, use_poll[, map[,count]]]])

   ポーリングループを開始し、count回が過ぎるか、全てのオープン済みチャ ネルがクローズされた場合のみ終了します。全ての引数はオプションです。
   引数*count*のデフォルト値はNoneで、ループは全てのチャネルがクロー ズされた場合のみ終了します。 引数*timeout*は
   :func:`select`または:func:`poll`の引数timeoutとして渡され、
   秒単位で指定します。デフォルト値は30秒です。引数*use_poll*が真のと
   き、:func:`select`ではなく:func:`poll`が使われます。デフォル ト値は``False``です。

   引数*map*には、監視するチャネルをアイテム として格納した辞書を指定します。*map*が省略された場合、グローバル なマップが使用されます。


</pre>
</div>
<p class="dispatcher">:class:<a href="#id21"><span class="problematic" id="id22">`</span></a>dispatcher`クラスは、低レベルソケットオブジェクトの薄いラッ パーです。便宜上、非同期ループから呼び出されるイベント処理メソッドを
追加していますが、これ以外の点では、non-blockingなソケットと同様で す。</p>
<div class="dispatcher system-message" id="id21">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">library/asyncore.rst</tt>, line 48); <em><a href="#id22">backlink</a></em></p>
Inline interpreted text or phrase reference start-string without end-string.</div>
<p class="dispatcher">:class:<a href="#id23"><span class="problematic" id="id24">`</span></a>dispatcher`クラスには二つのクラス属性があり、パフォーマンス向上 やメモリの削減のために更新する事ができます。</p>
<div class="dispatcher system-message" id="id23">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">library/asyncore.rst</tt>, line 51); <em><a href="#id24">backlink</a></em></p>
Inline interpreted text or phrase reference start-string without end-string.</div>
<div class="dispatcher system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">library/asyncore.rst</tt>, line 54)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: ac_in_buffer_size

   非同期入力バッファのサイズ(デフォルト ``4096``)


</pre>
</div>
<div class="dispatcher system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">library/asyncore.rst</tt>, line 59)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: ac_out_buffer_size

   非同期出力バッファのサイズ(デフォルト ``4096``)

</pre>
</div>
<p class="dispatcher">非同期ループ内で低レベルイベントが発生した場合、発生のタイミングやコネ クションの状態から特定の高レベルイベントへと置き換えることができます。
例えばソケットを他のホストに接続する場合、最初の書き込み可能イベントが 発生すれば接続が完了した事が分かります(この時点で、ソケットへの書き込
みは成功すると考えられる)。このように判定できる高レベルイベントを以下 に示します：</p>
<div class="dispatcher system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">library/asyncore.rst</tt>, line 67)</p>
<p>Malformed table.</p>
<pre class="literal-block">
+----------------------+-----------------------------------------------------+
| イベント                 | 解説                                                  |
+======================+=====================================================+
| ``handle_connect()`` | 最初にwriteイベントが発生した時                                  |
+----------------------+-----------------------------------------------------+
| ``handle_close()``   | 読み込み可能なデータなしでreadイベントが発生 した時                        |
+----------------------+-----------------------------------------------------+
| ``handle_accept()``  | listen中のソケットでreadイベントが発生した時                         |
+----------------------+-----------------------------------------------------+
</pre>
</div>
<p class="dispatcher">非同期処理中、マップに登録されたチャネルの:meth:<a href="#id25"><span class="problematic" id="id26">`</span></a>readable`メソッド
と:meth:<a href="#id27"><span class="problematic" id="id28">`</span></a>writable`メソッドが呼び出され、:cfunc:<a href="#id29"><span class="problematic" id="id30">`</span></a>select`か
:cfunc:<a href="#id31"><span class="problematic" id="id32">`</span></a>poll`でread/writeイベントを検出するリストに登録するか否か を判定します。</p>
<div class="dispatcher system-message" id="id25">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">library/asyncore.rst</tt>, line 77); <em><a href="#id26">backlink</a></em></p>
Inline interpreted text or phrase reference start-string without end-string.</div>
<div class="dispatcher system-message" id="id27">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">library/asyncore.rst</tt>, line 77); <em><a href="#id28">backlink</a></em></p>
Inline interpreted text or phrase reference start-string without end-string.</div>
<div class="dispatcher system-message" id="id29">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">library/asyncore.rst</tt>, line 77); <em><a href="#id30">backlink</a></em></p>
Inline interpreted text or phrase reference start-string without end-string.</div>
<div class="dispatcher system-message" id="id31">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">library/asyncore.rst</tt>, line 77); <em><a href="#id32">backlink</a></em></p>
Inline interpreted text or phrase reference start-string without end-string.</div>
<p>このようにして、チャネルでは低レベルなソケットイベントの種類より多くの種 類のイベントを検出する事ができます。以下にあげるイベントは、サブクラスで
オーバライドすることが可能です：</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">library/asyncore.rst</tt>, line 85)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: dispatcher.handle_read()

   非同期ループで、チャネルのソケットの:meth:`read`メソッドの呼び出しが 成功した時に呼び出されます。


</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">library/asyncore.rst</tt>, line 90)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: dispatcher.handle_write()

   非同期ループで、書き込み可能ソケットが実際に書き込み可能になった時に呼 び出される。このメソッドは、パフォーマンスの向上のためバッファリングを
   行う場合などに利用できます。例：  ::

      def handle_write(self):
          sent = self.send(self.buffer)
          self.buffer = self.buffer[sent:]


</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">library/asyncore.rst</tt>, line 100)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: dispatcher.handle_expt()

   out of band (OOB)データが検出された時に呼び出されます。OOBはあまりサポー
   トされておらず、また滅多に使われないので、:meth:`handle_expt`が呼び 出されることはほとんどありません。


</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">library/asyncore.rst</tt>, line 106)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: dispatcher.handle_connect()

   ソケットの接続が確立した時に呼び出されます。&quot;welcome&quot;バナーの送信、プ ロトコルネゴシエーションの初期化などを行います。

   .. % ちょっと手抜き...


</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">library/asyncore.rst</tt>, line 113)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: dispatcher.handle_close()

   ソケットが閉じた時に呼び出されます。


</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">library/asyncore.rst</tt>, line 118)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: dispatcher.handle_error()

   捕捉されない例外が発生した時に呼び出されます。デフォルトでは、短縮したト レースバック情報が出力されます。


</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">library/asyncore.rst</tt>, line 123)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: dispatcher.handle_accept()

   listen中のチャネルがリモートホストからの:meth:`connect`で接続され、 接続が確立した時に呼び出されます。

   .. % 手抜き...


</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">library/asyncore.rst</tt>, line 130)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: dispatcher.readable()

   非同期ループ中に呼び出され、readイベントの監視リストに加えるか否かを決 定します。デフォルトのメソッドでは``True``を返し、readイベントの発
   生を監視します。


</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">library/asyncore.rst</tt>, line 136)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: dispatcher.writable()

   非同期ループ中に呼び出され、writeイベントの監視リストに加えるか否かを 決定します。デフォルトのメソッドでは``True``を返し、writeイベントの
   発生を監視します。

</pre>
</div>
<p>さらに、チャネルにはソケットのメソッドとほぼ同じメソッドがあり、チャネル はソケットのメソッドの多くを委譲・拡張しており、ソケットとほぼ同じメソッ
ドを持っています。</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">library/asyncore.rst</tt>, line 145)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: dispatcher.create_socket(family, type)

   引数も含め、通常のソケット生成と同じ。:mod:`socket`モジュールを参 照のこと。


</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">library/asyncore.rst</tt>, line 150)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: dispatcher.connect(address)

   通常のソケットオブジェクトと同様、*address*には一番目の値が接続先 ホスト、2番目の値がポート番号であるタプルを指定します。


</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">library/asyncore.rst</tt>, line 155)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: dispatcher.send(data)

   リモート側の端点に*data*を送出します。


</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">library/asyncore.rst</tt>, line 160)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: dispatcher.recv(buffer_size)

   リモート側の端点より、最大*buffer_size*バイトのデータを読み込みま す。長さ0の文字列が返ってきた場合、チャネルはリモートから切断された事
   を示します。


</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">library/asyncore.rst</tt>, line 166)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: dispatcher.listen(backlog)

   ソケットへの接続を待つ。引数*backlog*は、キューイングできるコネク ションの最大数を指定します(1以上)。最大数はシステムに依存でします（通 常は5)


</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">library/asyncore.rst</tt>, line 171)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: dispatcher.bind(address)

   ソケットを*address*にバインドします。ソケットはバインド済みであっ てはなりません。(*address*の形式は、アドレスファミリに依存します。
   :mod:`socket`モジュールを参照のこと。)


</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">library/asyncore.rst</tt>, line 177)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: dispatcher.accept()

   接続を受け入れます。ソケットはアドレスにバインド済みであり、 :meth:`listen`で接続待ち状態でなければなりません。戻り値は ``(conn,
   address)``のペアで、*conn*はデータの送受信 を行うソケットオブジェクト、*address*は接続先ソケットがバインドさ れているアドレスです。


</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">library/asyncore.rst</tt>, line 183)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: dispatcher.close()

   ソケットをクローズします。以降の全ての操作は失敗します。リモート端点で は、キューに溜まったデータ以外、これ以降のデータ受信は行えません。ソケ
   ットはガベージコレクト時に自動的にクローズされます。


</pre>
</div>
<div class="section" id="asyncore-http">
<span id="asyncore-example"></span><h1>asyncoreの例：簡単なHTTPクライアント</h1>
<p>基本的なサンプルとして、以下に非常に単純なHTTPクライアントを示します。こ
のHTTPクライアントは:class:<a href="#id33"><span class="problematic" id="id34">`</span></a>dispatcher`クラスでソケットを利用しています。</p>
<div class="system-message" id="id33">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">library/asyncore.rst</tt>, line 194); <em><a href="#id34">backlink</a></em></p>
Inline interpreted text or phrase reference start-string without end-string.</div>
<pre class="literal-block">
import asyncore, socket

class http_client(asyncore.dispatcher):

    def __init__(self, host, path):
        asyncore.dispatcher.__init__(self)
        self.create_socket(socket.AF_INET, socket.SOCK_STREAM)
        self.connect( (host, 80) )
        self.buffer = 'GET %s HTTP/1.0\r\n\r\n' % path

    def handle_connect(self):
        pass

    def handle_close(self):
        self.close()

    def handle_read(self):
        print self.recv(8192)

    def writable(self):
        return (len(self.buffer) &gt; 0)

    def handle_write(self):
        sent = self.send(self.buffer)
        self.buffer = self.buffer[sent:]

c = http_client('www.python.org', '/')

asyncore.loop()
</pre>
</div>
</div>
</body>
</html>
